"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(r,t,i){return t&&e(r.prototype,t),i&&e(r,i),r}}(),Promise=require("bluebird"),_=require("underscore"),Excel=require("./lib/Excel"),SheetHelper=require("./lib/sheetHelper"),isNode=require("detect-node"),output_buffer={type:isNode?"nodebuffer":"blob",compression:"DEFLATE"},SINGLE_DATA="SINGLE_DATA",MULTI_FILE="MULTI_FILE",MULTI_SHEET="MULTI_SHEET",ExcelMerge=function(){function e(){_classCallCheck(this,e),this.sheetHelper=new SheetHelper}return _createClass(e,[{key:"load",value:function(e){var r=this;return e instanceof Excel?this.sheetHelper.load(e).then(function(){return r}):Promise.reject("First parameter must be Excel instance including MS-Excel data")}},{key:"mergeByType",value:function(e,r){switch(e){case SINGLE_DATA:return this.merge(r);case MULTI_FILE:return this.bulkMergeMultiFile(r);case MULTI_SHEET:return this.bulkMergeMultiSheet(r);default:return Promise.reject("Invalid parameter : mergeType")}}},{key:"merge",value:function(e){return e?this.sheetHelper.simpleMerge(e):Promise.reject("merge() must has parameter")}},{key:"bulkMergeMultiFile",value:function(e){return e?this.sheetHelper.bulkMergeMultiFile(e):Promise.reject("bulkMergeMultiFile() must has parameter")}},{key:"bulkMergeMultiSheet",value:function(e){var r=this;return e&&_.isArray(e)?(_.each(e,function(e){var t=e.name,i=e.data;return r.sheetHelper.addSheetBindingData(t,i)}),this.sheetHelper.deleteTemplateSheet().focusOnFirstSheet().generate(output_buffer)):Promise.reject("bulkMergeMultiSheet() must has array as parameter")}},{key:"variables",value:function(){return this.sheetHelper.templateVariables()}}]),e}();module.exports=ExcelMerge;