"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var l=r[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(r,t,l){return t&&e(r.prototype,t),l&&e(r,l),r}}(),Promise=require("bluebird"),_=require("underscore"),Excel=require("./lib/Excel"),SheetHelper=require("./lib/sheetHelper"),isNode=require("detect-node"),output_buffer={type:isNode?"nodebuffer":"blob",compression:"DEFLATE"},SINGLE_DATA="SINGLE_DATA",MULTI_FILE="MULTI_FILE",MULTI_SHEET="MULTI_SHEET",ExcelMerge=function(){function e(){_classCallCheck(this,e),this.sheetHelper=new SheetHelper}return _createClass(e,[{key:"load",value:function(e){var r=this;return e instanceof Excel?this.sheetHelper.load(e).then(function(){return r}):Promise.reject("First parameter must be Excel instance including MS-Excel data")}},{key:"mergeByType",value:function(e,r){switch(e){case SINGLE_DATA:return this.merge(r);case MULTI_FILE:return this.bulkMergeMultiFile(r);case MULTI_SHEET:return this.bulkMergeMultiSheet(r);default:return Promise.reject("Invalid parameter : mergeType")}}},{key:"merge",value:function(e){return e?this.sheetHelper.simpleMerge(e):Promise.reject("merge() must has parameter")}},{key:"bulkMergeMultiFile",value:function(e){return e?this.sheetHelper.bulkMergeMultiFile(e):Promise.reject("bulkMergeMultiFile() must has parameter")}},{key:"bulkMergeMultiSheet",value:function(e){return e&&_.isArray(e)?this.sheetHelper.bulkMergeMultiSheet(e):Promise.reject("bulkMergeMultiSheet() must has array as parameter")}},{key:"variables",value:function(){return this.sheetHelper.excel.variables()}}]),e}();module.exports=ExcelMerge;