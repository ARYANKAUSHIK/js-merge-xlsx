"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}(),_=require("underscore");require("./underscore_mixin");var SharedStrings=function(){function t(e){_classCallCheck(this,t),this.rawData=e,this.strings=e.sst.si}return _createClass(t,[{key:"add",value:function(t){var e=this,s=this.strings.length;_.each(t,function(t,n){t.sharedIndex=s+n,e.strings.push(t)})}},{key:"value",value:function(){return this.strings?(this.rawData.sst.si=_.deleteProperties(this.strings,["sharedIndex","usingCells"]),this.rawData.sst.$.uniqueCount=this.strings.length,this.rawData.sst.$.count=this.strings.length,this.rawData):null}},{key:"filterWithVariable",value:function(){var t=[];return _.each(this.strings,function(e,s){_.stringValue(e.t)&&_.hasVariable(_.stringValue(e.t))&&(e.sharedIndex=s,t.push(e))}),t}},{key:"hasString",value:function(){return!!this.strings}}]),t}();module.exports=SharedStrings;